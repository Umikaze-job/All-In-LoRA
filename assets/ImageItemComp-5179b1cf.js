import{d as D,q as m,_ as $,o as f,c as p,h as u,t as b,e as C,w as E,j as k,T as B,F,i as L,n as P,C as v,D as h,g as _,A as N}from"./index-32431f85.js";import{a as s}from"./tag_name-6410ff4f.js";const x=D({props:{fileName:String,id:Number,selectedId:{type:Array,required:!0},imagePath:String,tagData:{type:Array,required:!1,validator:function(e){return e.every(t=>typeof t.tagname=="string"&&typeof t.tagcolor=="string")}}},data(){return{isActive:!1}},computed:{getTagData(){var e;return(e=this.tagData)==null?void 0:e.filter(t=>t.tagname!="")}},methods:{getTagName(e){return this.$t==null||this.$t(`tagName.${e.tagname}`)==`tagName.${e.tagname}`?e.tagname:this.$t(`tagName.${e.tagname}`)},ItemEnter(e){m({targets:e.target.children[2],duration:300,width:"100%",height:"100%",top:"0%",left:"0%",easing:"easeOutExpo"})},ItemLeave(e){m({targets:e.target.children[2],duration:300,width:0,height:0,top:"50%",left:"50%",easing:"easeOutExpo"})},OnSelected(e,t){m({targets:e,duration:1e3,opacity:[0,1],complete:function(){t()}})},OnNotSelected(e,t){m({targets:e,duration:1e3,opacity:[1,0],complete:function(){t()}})}}}),O={class:"h-[80%] absolute top-0 left-0 w-full flex flex-row justify-center p-1"},q=["src"],z={class:"truncate text-center w-full h-[20%] leading-10 absolute top-[80%] left-0"},R=u("div",{class:"absolute top-[50%] left-[50%] w-0 h-0 bg-NormalButtonHover rounded-lg z-[-2]"},null,-1),M={key:0,class:"absolute top-0 left-0 w-full h-full bg-NormalButtonColor rounded-lg z-[-1]"},V={class:"absolute top-0 left-0 z-0 flex flex-col gap-2 pt-2 pl-2"},j={class:"py-1 px-1 text-base"};function W(e,t,r,g,w,o){return f(),p("div",{onMouseenter:t[0]||(t[0]=(...i)=>e.ItemEnter&&e.ItemEnter(...i)),onMouseleave:t[1]||(t[1]=(...i)=>e.ItemLeave&&e.ItemLeave(...i)),class:"h-[200px] relative rounded-lg border-winBorder select-none cursor-pointer"},[u("div",O,[u("img",{src:e.imagePath,class:"max-h-full mx-auto my-auto pointer-events-none",alt:"",srcset:""},null,8,q)]),u("p",z,b(e.fileName),1),R,C(B,{onEnter:e.OnSelected,onLeave:e.OnNotSelected},{default:E(()=>[e.selectedId.includes(e.id)?(f(),p("div",M)):k("",!0)]),_:1},8,["onEnter","onLeave"]),u("div",V,[(f(!0),p(F,null,L(e.getTagData,(i,y)=>(f(),p("div",{class:"relative text-center",key:y},[u("div",{class:P(`absolute w-full h-full rounded-lg z-[-1] top-0 left-0 opacity-50 border-winBorder border-white ${i.tagcolor}`)},null,2),u("p",j,b(e.getTagName(i)),1)]))),128))])],32)}const X=$(x,[["render",W]]);function Y(){const e=v([-1]),t=v(!1),r=v({base:[],after:[]}),g=v(0),w=function(a){t.value?e.value[0]==-1?e.value=[a]:e.value.includes(a)?e.value=e.value.filter(l=>l!=a):e.value.push(a):e.value=[a]},o=h({get:()=>g.value==0?r.value.base:r.value.after,set:a=>{g.value==0?r.value.base=a:r.value.after=a}}),i=h(()=>e.value[0]==-1||e.value.length==0?[]:g.value==0?e.value.map(a=>r.value.base[a]):e.value.map(a=>r.value.after[a])),y=function(a){return a.split("\\").slice(-1)[0]},S=function(){e.value=Array.from({length:o.value.length},(a,l)=>l)},T=h(()=>e.value[0]!=-1&&e.value.length!=0?o.value.filter((l,c)=>e.value.includes(c)).map(l=>l.image_url):[""]),A=h(()=>e.value[0]!=-1&&e.value.length!=0?o.value.filter((l,c)=>e.value.includes(c)).map(l=>l.thumbnail_path):[""]);return{selecting_id:e,isMultipleSelect:t,ImageDataSet:r,ImageFolderID:g,selectImageItemID:w,selectingImageItems:i,selectingImageDataSet:o,clickAllItems:S,ImageWindowPreview:T,ImageWindowThumbnailPreview:A,getFileNameFromUrl:y,setAlready_CaptionTag:async function(a){const l=await a.axios.post(_()+"/api/make-textfile/tagging/alreadytag",{folderName:N().getSelectingFolderName}),c=await a.axios.post(_()+"/api/make-textfile/captioning/captiontag",{folderName:N().getSelectingFolderName});r.value.base.forEach(n=>{n.tags=n.tags.filter(I=>![s.alreadyTag.name,s.captionAlready.name].includes(I.tagname));const d=n.image_url.split("\\").slice(-1)[0];l.data.base_images.includes(d)&&n.tags.push({tagname:s.alreadyTag.name,tagcolor:s.alreadyTag.color}),c.data.base_images.includes(d)&&n.tags.push({tagname:s.captionAlready.name,tagcolor:s.captionAlready.color})}),r.value.after.forEach(n=>{n.tags=n.tags.filter(I=>I.tagname!=s.alreadyTag.name);const d=n.image_url.split("\\").slice(-1)[0];l.data.after_images.includes(d)&&n.tags.push({tagname:s.alreadyTag.name,tagcolor:s.alreadyTag.color}),c.data.after_images.includes(d)&&n.tags.push({tagname:s.captionAlready.name,tagcolor:s.captionAlready.color})})},ImageFolderRowButtonClick:function(a){g.value=a,e.value=[-1]},PreviewImageSelectLeft:function(){let a=e.value[0];a=a-1,a=a%o.value.length,a<0&&(a=o.value.length-1),e.value=[a]},PreviewImageSelectRight:function(){let a=e.value[0];a=a+1,a=a%o.value.length,e.value=[a]}}}export{X as D,Y as I};
