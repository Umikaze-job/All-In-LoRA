import{d as N,q as w,_ as v,o as c,c as p,F as _,i as x,h as g,n as b,t as I,j as F,m as E,b as T,A as M,g as f,r as o,e as n,w as u,f as R}from"./index-09c46877.js";import{T as V}from"./template01-92276447.js";import{m as S}from"./mini-Button01-fadaf757.js";import{I as k,T as d}from"./ImageItemComp-5cb7bdd1.js";import{m as B}from"./ModalItemComp-450d0411.js";import{m as z}from"./modal-LoadingBar01-be170e50.js";const A=N({props:{addClass:String,subItems:Array,nowId:Number,paths:Array},methods:{getTextClass(e){return e==this.nowId?"bg-NormalButtonColor p-1 rounded-sm":"p-1 rounded-sm"},mouseEnterItem(e){const s=e.target;s.children[0].classList.add("left-0"),s.children[0].classList.remove("right-0"),w({targets:s.children[0],width:"100%",easing:"easeOutExpo",duration:300})},mouseLeaveItem(e){const s=e.target;s.children[0].classList.remove("left-0"),s.children[0].classList.add("right-0"),w({targets:s.children[0],width:"0",easing:"easeOutExpo",duration:300})},gotoPath(e){const s=this.paths[e];this.$router.push({name:s})}}}),U=["onClick"],q=g("div",{class:"w-0 h-full absolute bg-NormalButtonHover top-0 left-0 z-[-1]"},null,-1),O={key:0,class:"bg-white w-[2px] h-[80%]"};function P(e,s,r,i,t,a){return c(),p("div",{class:b("text-white font-Raleway text-xl flex flex-row justify-start gap-3 items-center select-none "+e.addClass)},[(c(!0),p(_,null,x(e.subItems,(h,l)=>(c(),p(_,{key:l},[g("div",{class:"relative cursor-pointer",onMouseenter:s[0]||(s[0]=(...m)=>e.mouseEnterItem&&e.mouseEnterItem(...m)),onMouseleave:s[1]||(s[1]=(...m)=>e.mouseLeaveItem&&e.mouseLeaveItem(...m)),onClick:m=>e.gotoPath(l)},[q,g("p",{class:b(e.getTextClass(l))},I(h),3)],40,U),l!=e.subItems.length-1?(c(),p("div",O)):F("",!0)],64))),128))],2)}const j=v(A,[["render",P]]),D=N({setup(e,s){const{isModal:r,canModalCancel:i,canControl:t}=B(),{getFileNameFromUrl:a}=k();return{isModal:r,canModalCancel:i,canControl:t,getFileNameFromUrl:a}},components:{"base-tem":V,"mini-button":S,"button-set":j,"modal-base":E,"modal-window":T,"modal-load":z},data(){return{pathName:["ct-select-files","ct-trimming-setting","ct-output-folder"],store:M(),LoadingValue:{max:0,value:0}}},computed:{getSubPageId(){const e=this.$route.name;return this.pathName.indexOf(e)}},methods:{async startTrimming(){this.isModal=!0,this.canControl(!1);const e=await this.store.getImageEditFiles.filter(t=>t.tags.findIndex(a=>a.tagname==d()[0].id)!=-1).map(t=>({file_name:this.getFileNameFromUrl(t.image_url),displayedName:t.file_name,isResize:t.tags.findIndex(a=>a.tagname==d()[3].id)!=-1})),s=await this.store.getImageEditFiles.filter(t=>t.tags.findIndex(a=>a.tagname==d()[1].id)!=-1).map(t=>({file_name:this.getFileNameFromUrl(t.image_url),displayedName:t.file_name,isResize:t.tags.findIndex(a=>a.tagname==d()[3].id)!=-1})),r=await this.store.getImageEditFiles.filter(t=>t.tags.findIndex(a=>a.tagname==d()[2].id)!=-1).map(t=>({file_name:this.getFileNameFromUrl(t.image_url),displayedName:t.file_name,isResize:t.tags.findIndex(a=>a.tagname==d()[3].id)!=-1}));if(this.LoadingValue={max:0,value:0},this.LoadingValue.max=e.length+s.length+r.length,this.LoadingValue.max==0){this.store.setErrorMessage("None of the images have tags."),this.isModal=!1;return}let i=!1;for(const t of e){const a=await this.axios.post(f()+"/api/processing-images/start-trimming",{folderName:this.store.getSelectingFolderName.id,fileName:t.file_name,displayedName:`${t.displayedName}_character`,setting:this.store.getImageEditSetting,isResize:t.isResize,type:"Character"});if(a.data.error==null)this.LoadingValue.value+=1;else{this.isModal=!1,this.store.setErrorMessage(a.data.error),i=!0;break}}if(i==!1)for(const t of s){const a=await this.axios.post(f()+"/api/processing-images/start-trimming",{folderName:this.store.getSelectingFolderName.id,fileName:t.file_name,displayedName:`${t.displayedName}_face`,setting:this.store.getImageEditSetting,isResize:t.isResize,type:"Face"});if(a.data.error==null)this.LoadingValue.value+=1;else{this.isModal=!1,i=!0,this.store.setErrorMessage(a.data.error);break}}if(i==!1)for(const t of r){const a=await this.axios.post(f()+"/api/processing-images/start-trimming",{folderName:this.store.getSelectingFolderName.id,fileName:t.file_name,displayedName:`${t.displayedName}_body`,setting:this.store.getImageEditSetting,isResize:t.isResize,type:"Body"});if(a.data.error==null)this.LoadingValue.value+=1;else{this.isModal=!1,i=!0,this.store.setErrorMessage(a.data.error);break}}this.canControl(!0),this.isModal=!1}}}),H={class:"flex flex-row text-center text-lg text-white font-Raleway"},W={class:"basis-1/5 flex flex-row justify-end"},G=g("p",{class:"text-center text-xl underline decoration-myUnderLine01 py-8"},"Loading...",-1);function J(e,s,r,i,t,a){const h=o("button-set"),l=o("mini-button"),m=o("RouterView"),C=o("base-tem"),y=o("modal-load"),$=o("modal-window"),L=o("modal-base");return c(),p(_,null,[n(C,null,{maintitle:u(()=>[R(I(e.$t("topbar.EditImages.ManipulatingImages")),1)]),buttonContents:u(()=>[g("div",H,[n(h,{paths:e.pathName,"now-id":e.getSubPageId,"add-class":"grow","sub-items":[e.$t("CharacterTrimming.RowButtons.TagsToFile"),e.$t("CharacterTrimming.RowButtons.Setting"),e.$t("CharacterTrimming.RowButtons.OutputFolder")]},null,8,["paths","now-id","sub-items"]),g("div",W,[n(l,{onClick:e.startTrimming,addClass:"ml-2",buttonName:e.$t("CharacterTrimming.Trimming"),"button-color-hover":"bg-ApplyColor"},null,8,["onClick","buttonName"])])])]),mainContents:u(()=>[n(m,{name:"subView"})]),_:1}),n(L,{"is-window":e.isModal,"can-background-cancel":e.canModalCancel},{default:u(()=>[n($,null,{default:u(()=>[G,n(y,{"value-max":e.LoadingValue.max,"now-value":e.LoadingValue.value},null,8,["value-max","now-value"])]),_:1})]),_:1},8,["is-window","can-background-cancel"])],64)}const te=v(D,[["render",J]]);export{te as default};
